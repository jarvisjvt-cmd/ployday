<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy Birthday üéÇ</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Sarabun:wght@300;400;600&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
:root{--rose:#e8647a;--blush:#f4a7b3;--cream:#fdf6f0;--gold:#c9a96e;--deep:#2d1b2e;--soft-purple:#7c5c8a;}
html,body{height:100%;overflow:hidden;}
body{min-height:100vh;background:var(--deep);display:flex;align-items:center;justify-content:center;font-family:'Sarabun',sans-serif;position:relative;}
.stars{position:fixed;inset:0;pointer-events:none;z-index:0;}
.star{position:absolute;background:white;border-radius:50%;animation:twinkle var(--dur) ease-in-out infinite;animation-delay:var(--delay);opacity:0;}
@keyframes twinkle{0%,100%{opacity:0;transform:scale(0.5);}50%{opacity:0.8;transform:scale(1);}}
.page{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:1;opacity:0;pointer-events:none;transition:opacity 0.7s ease;overflow:hidden;}
.page.active{opacity:1;pointer-events:all;}
@keyframes fadeUp{from{opacity:0;transform:translateY(24px);}to{opacity:1;transform:translateY(0);}}
@keyframes bounceIn{from{opacity:0;transform:scale(0) rotate(-20deg);}to{opacity:1;transform:scale(1) rotate(0);}}
@keyframes shake{0%,100%{transform:translateX(0);}20%,60%{transform:translateX(-8px);}40%,80%{transform:translateX(8px);}}
.welcome-box{background:linear-gradient(160deg,#3d1f45,#5c2d5e 50%,#2d1b2e);border:1px solid rgba(201,169,110,0.3);border-radius:28px;padding:48px 36px;width:min(420px,92vw);text-align:center;box-shadow:0 30px 80px rgba(0,0,0,0.6);position:relative;overflow:hidden;transition:all 0.6s ease;}
.welcome-box::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 50% 0%,rgba(255,255,255,0.06) 0%,transparent 60%);}
.welcome-emoji{font-size:60px;display:block;margin-bottom:16px;animation:bounceIn 1s cubic-bezier(.34,1.56,.64,1) 0.3s both;}
.welcome-title{font-family:'Playfair Display',serif;font-style:italic;font-size:28px;color:#fff;margin-bottom:8px;animation:fadeUp 0.8s ease 0.5s both;}
.welcome-sub{font-size:14px;color:rgba(255,255,255,0.55);margin-bottom:36px;animation:fadeUp 0.8s ease 0.65s both;line-height:1.7;}
.gold-div{display:flex;align-items:center;gap:12px;margin:0 0 28px;}
.gold-div::before,.gold-div::after{content:'';flex:1;height:1px;background:linear-gradient(to right,transparent,var(--gold));}
.gold-div::after{background:linear-gradient(to left,transparent,var(--gold));}
.gold-div span{color:var(--gold);font-size:16px;}
.date-label{font-size:11px;letter-spacing:3px;text-transform:uppercase;color:var(--blush);margin-bottom:12px;animation:fadeUp 0.8s ease 0.8s both;}
.date-inputs{display:flex;gap:10px;justify-content:center;margin-bottom:24px;animation:fadeUp 0.8s ease 0.9s both;}
.date-inputs input{background:rgba(255,255,255,0.08);border:1.5px solid rgba(201,169,110,0.4);border-radius:12px;padding:14px 8px;color:white;font-size:20px;font-family:'Sarabun',sans-serif;font-weight:600;text-align:center;outline:none;transition:all 0.2s;-moz-appearance:textfield;}
.date-inputs input::-webkit-outer-spin-button,.date-inputs input::-webkit-inner-spin-button{-webkit-appearance:none;}
.date-inputs input:focus{border-color:var(--gold);background:rgba(255,255,255,0.12);}
.date-inputs input::placeholder{color:rgba(255,255,255,0.25);font-size:13px;}
#inp-day,#inp-month{width:72px;}
#inp-year{width:90px;}
.date-sep{color:var(--gold);font-size:22px;align-self:center;}
.btn-enter{width:100%;padding:15px;background:linear-gradient(135deg,var(--rose),#c94560);color:white;border:none;border-radius:14px;font-family:'Sarabun',sans-serif;font-size:15px;font-weight:600;cursor:pointer;box-shadow:0 8px 24px rgba(232,100,122,0.4);transition:all 0.2s;animation:fadeUp 0.8s ease 1s both;letter-spacing:1px;}
.btn-enter:hover{transform:translateY(-2px);}
.error-msg{color:#ff8fa3;font-size:13px;margin-top:14px;opacity:0;transition:opacity 0.3s;min-height:20px;}
.error-msg.show{opacity:1;}
.shake{animation:shake 0.4s ease !important;}
.cake-page{width:100vw;max-width:620px;text-align:center;padding:10px 12px 6px;display:flex;flex-direction:column;align-items:center;}
.cake-title{font-family:'Playfair Display',serif;font-style:italic;font-size:20px;color:var(--blush);margin-bottom:3px;animation:fadeUp 0.7s ease 0.2s both;}
.cake-sub{font-size:12px;color:rgba(255,255,255,0.45);margin-bottom:8px;letter-spacing:1px;animation:fadeUp 0.7s ease 0.35s both;}
.mic-area{display:flex;flex-direction:row;align-items:center;justify-content:center;gap:10px;margin-bottom:6px;animation:fadeUp 0.7s ease 0.5s both;}
.mic-label{font-size:11px;color:rgba(255,255,255,0.5);letter-spacing:1px;}
.vol-bar-wrap{width:160px;height:7px;background:rgba(255,255,255,0.1);border-radius:10px;overflow:hidden;}
.vol-bar-fill{height:100%;border-radius:10px;width:0%;transition:width 0.08s;background:linear-gradient(90deg,#4caf50,#8bc34a,#ffeb3b,#ff9800,#f44336);}
.cake-wrapper{position:relative;width:min(580px,96vw);animation:fadeUp 0.8s ease 0.4s both;}
.cake-wrapper svg{width:100%;height:auto;display:block;}
.candles-container{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;}
.candle-wrap{position:absolute;transform:translateX(-50%);display:flex;flex-direction:column;align-items:center;}
.c-flame-area{position:relative;width:26px;height:34px;display:flex;align-items:center;justify-content:center;transition:opacity 0.5s;}
.c-flame-area.out{opacity:0;}
.c-glow{position:absolute;width:34px;height:34px;border-radius:50%;background:radial-gradient(circle,rgba(255,210,60,0.7) 0%,transparent 70%);animation:glowP 1s ease-in-out infinite alternate;}
@keyframes glowP{from{transform:scale(0.85);opacity:0.8;}to{transform:scale(1.3);opacity:0.35;}}
.c-flame-outer{position:absolute;width:17px;height:25px;border-radius:50% 50% 45% 45%/60% 60% 40% 40%;background:radial-gradient(ellipse at 50% 85%,#ffe566 0%,#ff8c00 55%,#ff4500 100%);transform-origin:bottom center;animation:fOut 0.75s ease-in-out infinite alternate;}
.c-flame-inner{position:absolute;bottom:2px;width:9px;height:16px;border-radius:50% 50% 45% 45%/60% 60% 40% 40%;background:radial-gradient(ellipse at 50% 80%,#ffffff 0%,#fff9c4 50%,#ffe566 100%);transform-origin:bottom center;animation:fIn 0.55s ease-in-out infinite alternate;}
@keyframes fOut{0%{transform:scaleX(1) scaleY(1) rotate(-1deg);}50%{transform:scaleX(0.86) scaleY(1.12) rotate(1.5deg);}100%{transform:scaleX(1.1) scaleY(0.9) rotate(-0.5deg);}}
@keyframes fIn{0%{transform:scaleX(1) scaleY(1);}50%{transform:scaleX(0.82) scaleY(1.15);}100%{transform:scaleX(1.12) scaleY(0.88);}}
.c-smoke-emoji{position:absolute;bottom:100%;left:50%;transform:translateX(-50%);font-size:14px;opacity:0;pointer-events:none;}
.c-smoke-emoji.puffing{animation:smokeUp 1.1s ease-out forwards;}
@keyframes smokeUp{0%{opacity:0.9;transform:translateX(-50%) translateY(0) scale(1);}100%{opacity:0;transform:translateX(-50%) translateY(-30px) scale(0.5);}}
.c-wick-tip{width:4px;height:4px;border-radius:50%;background:#222;margin-bottom:1px;}
.c-wick{width:2px;height:7px;background:linear-gradient(to bottom,#666,#222);border-radius:1px;margin-bottom:-1px;}
.c-body{width:18px;border-radius:5px 5px 3px 3px;position:relative;overflow:hidden;box-shadow:2px 3px 6px rgba(0,0,0,0.35);}
.c-body-shine{position:absolute;left:3px;top:5px;width:4px;height:52%;border-radius:3px;background:rgba(255,255,255,0.38);}
.c-drip{position:absolute;top:0;left:3px;width:8px;height:0;border-radius:0 0 4px 4px;opacity:0.85;transition:height 0.7s ease;}
.drip-active .c-drip{height:14px;}
.c-base{width:22px;height:7px;border-radius:3px;box-shadow:0 2px 4px rgba(0,0,0,0.3);margin-top:1px;}
.progress-bar-wrap{background:rgba(255,255,255,0.08);border-radius:20px;height:7px;width:220px;margin:8px auto 4px;overflow:hidden;}
.progress-bar-fill{height:100%;background:linear-gradient(90deg,var(--rose),var(--gold));border-radius:20px;width:100%;transition:width 0.5s cubic-bezier(.34,1.56,.64,1);}
.cake-hint{font-size:12px;color:rgba(255,255,255,0.4);animation:pulse 2s ease-in-out infinite;}
@keyframes pulse{0%,100%{opacity:0.4;}50%{opacity:0.95;}}
#page3{background:var(--deep);flex-direction:column;}
.photo-wall{width:100vw;max-width:700px;padding:24px 16px;text-align:center;}
.photo-wall-title{font-family:'Playfair Display',serif;font-style:italic;font-size:26px;color:var(--blush);margin-bottom:6px;}
.photo-wall-sub{font-size:13px;color:rgba(255,255,255,0.4);margin-bottom:28px;letter-spacing:1px;}
.polaroid-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;max-width:560px;margin:0 auto 28px;}
.polaroid{background:#fff;padding:10px 10px 36px;border-radius:3px;box-shadow:0 8px 30px rgba(0,0,0,0.5),0 2px 8px rgba(0,0,0,0.3);cursor:pointer;transition:transform 0.3s ease,box-shadow 0.3s;position:relative;opacity:0;transform:translateY(30px) rotate(var(--rot));animation:polaroidIn 0.6s ease forwards;animation-delay:var(--del);}
@keyframes polaroidIn{to{opacity:1;transform:translateY(0) rotate(var(--rot));}}
.polaroid:hover{transform:translateY(-6px) rotate(0deg) scale(1.05);box-shadow:0 20px 50px rgba(0,0,0,0.6);z-index:10;}
.polaroid-img{width:100%;aspect-ratio:1;border-radius:2px;overflow:hidden;background:linear-gradient(135deg,var(--c1),var(--c2));display:flex;align-items:center;justify-content:center;font-size:48px;}
.polaroid-caption{font-family:'Dancing Script',cursive;font-size:13px;color:#5a3050;margin-top:6px;text-align:center;line-height:1.3;}
.photo-wall-btn{padding:14px 40px;background:linear-gradient(135deg,var(--rose),#c94560);color:white;border:none;border-radius:14px;font-family:'Sarabun',sans-serif;font-size:15px;font-weight:600;cursor:pointer;box-shadow:0 8px 24px rgba(232,100,122,0.4);transition:all 0.2s;letter-spacing:1px;}
.photo-wall-btn:hover{transform:translateY(-2px);}
#page4{background:var(--deep);align-items:flex-start;overflow-y:auto;}
.timeline-wrap{width:100%;max-width:500px;padding:40px 20px 60px;margin:0 auto;}
.tl-header{text-align:center;margin-bottom:40px;}
.tl-title{font-family:'Playfair Display',serif;font-style:italic;font-size:28px;color:var(--blush);margin-bottom:6px;}
.tl-sub{font-size:13px;color:rgba(255,255,255,0.4);letter-spacing:2px;}
.tl-line{position:relative;padding-left:44px;}
.tl-line::before{content:'';position:absolute;left:15px;top:0;bottom:0;width:2px;background:linear-gradient(to bottom,var(--rose),var(--gold),var(--soft-purple));}
.tl-item{position:relative;margin-bottom:36px;opacity:0;transform:translateX(-20px);animation:tlIn 0.6s ease forwards;animation-delay:var(--del);}
@keyframes tlIn{to{opacity:1;transform:translateX(0);}}
.tl-dot{position:absolute;left:-38px;top:4px;width:16px;height:16px;border-radius:50%;background:var(--rose);border:3px solid var(--deep);box-shadow:0 0 0 2px var(--rose);}
.tl-date{font-size:10px;letter-spacing:2px;color:var(--gold);text-transform:uppercase;margin-bottom:4px;}
.tl-text{font-size:14px;color:rgba(255,255,255,0.85);line-height:1.7;}
.tl-emoji{font-size:22px;margin-bottom:6px;display:block;}
.tl-card{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:14px;padding:16px;}
.tl-next-btn{display:block;margin:0 auto;padding:14px 40px;background:linear-gradient(135deg,var(--rose),#c94560);color:white;border:none;border-radius:14px;font-family:'Sarabun',sans-serif;font-size:15px;font-weight:600;cursor:pointer;box-shadow:0 8px 24px rgba(232,100,122,0.4);transition:all 0.2s;letter-spacing:1px;}
#page5{background:var(--deep);}
.envelope-scene{position:relative;width:min(420px,92vw);height:320px;display:flex;align-items:center;justify-content:center;}
.envelope-wrap{position:relative;width:360px;height:220px;cursor:pointer;}
.env-body{position:absolute;inset:0;background:linear-gradient(160deg,#fff8f0,#ffe4d4);border-radius:8px;box-shadow:0 20px 60px rgba(0,0,0,0.5);}
.env-flap{position:absolute;top:0;left:0;right:0;height:50%;background:linear-gradient(160deg,#ffd4b8,#ffb89a);border-radius:8px 8px 0 0;clip-path:polygon(0 0,100% 0,50% 100%);transform-origin:top center;transition:transform 0.8s cubic-bezier(.34,1.4,.64,1);z-index:2;}
.env-flap.open{transform:rotateX(180deg);}
.env-left-fold{position:absolute;bottom:0;left:0;width:50%;height:50%;background:linear-gradient(135deg,#fce8d4,#ffd4b4);clip-path:polygon(0 100%,100% 50%,0 0);}
.env-right-fold{position:absolute;bottom:0;right:0;width:50%;height:50%;background:linear-gradient(225deg,#fce8d4,#ffd4b4);clip-path:polygon(100% 100%,0 50%,100% 0);}
.env-seal{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) translateY(-10px);z-index:3;width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,var(--rose),#c94560);display:flex;align-items:center;justify-content:center;font-size:18px;box-shadow:0 4px 16px rgba(232,100,122,0.6);transition:all 0.4s;cursor:pointer;}
.env-label{text-align:center;margin-bottom:20px;}
.env-title{font-family:'Playfair Display',serif;font-style:italic;font-size:22px;color:var(--blush);margin-bottom:6px;}
.env-hint{font-size:12px;color:rgba(255,255,255,0.4);animation:pulse 2s ease-in-out infinite;}
.env-page{display:flex;flex-direction:column;align-items:center;gap:16px;}
.letter-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.85);backdrop-filter:blur(12px);z-index:800;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity 0.5s;}
.letter-overlay.show{opacity:1;pointer-events:all;}
.letter-paper{width:min(380px,90vw);max-height:88vh;overflow-y:auto;background:#fffbf5;border-radius:4px;padding:0;box-shadow:0 40px 100px rgba(0,0,0,0.7);transform:translateY(60px) scale(0.9);opacity:0;transition:all 0.7s cubic-bezier(.34,1.56,.64,1) 0.15s;position:relative;}
.letter-overlay.show .letter-paper{transform:translateY(0) scale(1);opacity:1;}
.letter-content{position:relative;z-index:1;padding:40px 36px;background:repeating-linear-gradient(transparent,transparent 31px,#e0d4c8 31px,#e0d4c8 32px);background-position:0 39px;}
.letter-date{font-family:'Dancing Script',cursive;font-size:14px;color:#9a7060;text-align:right;line-height:32px;}
.letter-dear{font-family:'Dancing Script',cursive;font-size:20px;color:#5a3040;line-height:32px;}
.letter-body{font-family:'Dancing Script',cursive;font-size:16px;color:#4a3040;line-height:32px;}
.letter-close{position:absolute;top:12px;right:12px;background:var(--rose);border:none;color:white;width:30px;height:30px;border-radius:50%;cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center;z-index:10;}
#page6{background:var(--deep);}
.jar-scene{width:min(420px,92vw);text-align:center;}
.jar-title{font-family:'Playfair Display',serif;font-style:italic;font-size:24px;color:var(--blush);margin-bottom:6px;}
.jar-sub{font-size:13px;color:rgba(255,255,255,0.4);margin-bottom:24px;line-height:1.7;}
.jar-visual{position:relative;width:180px;height:220px;margin:0 auto 20px;}
.jar-body{position:absolute;bottom:0;left:10px;right:10px;height:180px;background:linear-gradient(160deg,rgba(200,230,255,0.25),rgba(150,180,255,0.1));border-radius:0 0 50px 50px;border:3px solid rgba(200,230,255,0.4);border-top:none;overflow:hidden;}
.jar-shine{position:absolute;top:20px;left:18px;width:20px;height:60px;background:rgba(255,255,255,0.2);border-radius:10px;transform:rotate(-15deg);}
.jar-neck{position:absolute;top:24px;left:20px;right:20px;height:32px;background:linear-gradient(160deg,rgba(200,230,255,0.2),rgba(150,180,255,0.08));border-radius:6px 6px 0 0;border:3px solid rgba(200,230,255,0.4);border-bottom:none;}
.jar-lid{position:absolute;top:0;left:14px;right:14px;height:30px;background:linear-gradient(135deg,#c9a96e,#e8c87a);border-radius:8px;box-shadow:0 4px 12px rgba(201,169,110,0.4);}
.jar-lid::after{content:'';position:absolute;top:-8px;left:50%;transform:translateX(-50%);width:24px;height:12px;background:linear-gradient(135deg,#e8c87a,#c9a96e);border-radius:6px 6px 0 0;}
.jar-wishes-inside{position:absolute;bottom:8px;left:0;right:0;display:flex;flex-wrap:wrap;gap:4px;padding:8px;justify-content:center;max-height:120px;overflow:hidden;}
.wish-note{background:linear-gradient(135deg,var(--rose),#c94560);border-radius:3px;width:28px;height:22px;opacity:0.85;animation:noteIn 0.4s ease;transform:rotate(var(--r));}
@keyframes noteIn{from{transform:scale(0) rotate(var(--r));}to{transform:scale(1) rotate(var(--r));}}
.jar-input-area{display:flex;flex-direction:column;gap:12px;align-items:center;}
.wish-input{width:100%;padding:14px 18px;background:rgba(255,255,255,0.07);border:1.5px solid rgba(201,169,110,0.3);border-radius:14px;color:white;font-family:'Sarabun',sans-serif;font-size:14px;outline:none;transition:all 0.2s;resize:none;line-height:1.6;}
.wish-input:focus{border-color:var(--gold);background:rgba(255,255,255,0.1);}
.wish-input::placeholder{color:rgba(255,255,255,0.3);}
.wish-submit-btn{padding:12px 36px;background:linear-gradient(135deg,var(--rose),#c94560);color:white;border:none;border-radius:12px;font-family:'Sarabun',sans-serif;font-size:14px;font-weight:600;cursor:pointer;box-shadow:0 6px 20px rgba(232,100,122,0.4);transition:all 0.2s;}
.jar-wishes-list{margin-top:16px;max-height:130px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;width:100%;padding-right:4px;}
.jar-wish-item{background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.08);border-radius:10px;padding:10px 14px;font-size:13px;color:rgba(255,255,255,0.8);text-align:left;display:flex;gap:8px;align-items:flex-start;}
.jar-wish-item::before{content:'‚ú¶';color:var(--gold);font-size:10px;margin-top:2px;flex-shrink:0;}
.jar-skip-btn{margin-top:16px;background:none;border:1px solid rgba(255,255,255,0.15);color:rgba(255,255,255,0.4);border-radius:10px;padding:8px 24px;font-family:'Sarabun',sans-serif;font-size:13px;cursor:pointer;transition:all 0.2s;}
.jar-skip-btn:hover{border-color:var(--gold);color:var(--gold);}
#page7{background:var(--deep);}
.countdown-scene{text-align:center;width:min(480px,92vw);}
.cd-title{font-family:'Playfair Display',serif;font-style:italic;font-size:26px;color:var(--blush);margin-bottom:6px;}
.cd-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:32px;}
.cd-box{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.1);border-radius:16px;padding:20px 8px 14px;}
.cd-num{font-family:'Playfair Display',serif;font-size:42px;font-weight:700;color:#fff;line-height:1;margin-bottom:6px;}
.cd-unit{font-size:10px;letter-spacing:2px;text-transform:uppercase;color:var(--gold);}
.cd-msg{font-family:'Playfair Display',serif;font-style:italic;font-size:18px;color:rgba(255,255,255,0.7);margin-bottom:32px;line-height:1.7;}
.cd-final-btn{padding:14px 40px;background:linear-gradient(135deg,var(--rose),#c94560);color:white;border:none;border-radius:14px;font-family:'Sarabun',sans-serif;font-size:15px;font-weight:600;cursor:pointer;box-shadow:0 8px 24px rgba(232,100,122,0.4);transition:all 0.2s;letter-spacing:1px;}
#page8{background:var(--deep);}
.song-scene{text-align:center;width:min(420px,92vw);}
.song-disc{width:200px;height:200px;border-radius:50%;background:conic-gradient(#1a0a1e,#3d1f45,#5c2d5e,#c9a96e,#e8647a,#5c2d5e,#1a0a1e);margin:0 auto 20px;position:relative;animation:spinDisc 4s linear infinite;animation-play-state:paused;box-shadow:0 10px 40px rgba(0,0,0,0.6);}
.song-disc.playing{animation-play-state:running;}
@keyframes spinDisc{from{transform:rotate(0deg);}to{transform:rotate(360deg);}}
.disc-center{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:60px;height:60px;border-radius:50%;background:var(--deep);display:flex;align-items:center;justify-content:center;font-size:22px;}
.song-title-el{font-family:'Playfair Display',serif;font-style:italic;font-size:20px;color:#fff;margin-bottom:4px;}
.song-artist{font-size:12px;color:rgba(255,255,255,0.4);margin-bottom:20px;letter-spacing:1px;}
.song-controls{display:flex;align-items:center;justify-content:center;gap:16px;margin-bottom:24px;}
.play-btn{width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,var(--rose),#c94560);border:none;color:white;font-size:24px;cursor:pointer;box-shadow:0 6px 20px rgba(232,100,122,0.5);transition:all 0.2s;display:flex;align-items:center;justify-content:center;}
.song-progress{width:100%;height:4px;background:rgba(255,255,255,0.1);border-radius:2px;margin-bottom:8px;cursor:pointer;overflow:hidden;}
.song-prog-fill{height:100%;background:linear-gradient(90deg,var(--rose),var(--gold));border-radius:2px;width:0%;transition:width 0.5s linear;}
.song-time{display:flex;justify-content:space-between;font-size:11px;color:rgba(255,255,255,0.35);margin-bottom:20px;}
.lyrics-box{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:20px;min-height:80px;font-family:'Dancing Script',cursive;font-size:17px;color:rgba(255,255,255,0.8);line-height:1.8;}
.lyric-line{transition:all 0.4s;opacity:0.3;}
.lyric-line.active{opacity:1;color:#fff;font-size:19px;}
.song-next-btn{margin-top:20px;padding:12px 32px;background:linear-gradient(135deg,var(--rose),#c94560);color:white;border:none;border-radius:12px;font-family:'Sarabun',sans-serif;font-size:14px;font-weight:600;cursor:pointer;box-shadow:0 6px 20px rgba(232,100,122,0.4);transition:all 0.2s;letter-spacing:1px;}
.popup-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.82);backdrop-filter:blur(10px);z-index:500;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity 0.5s;}
.popup-overlay.show{opacity:1;pointer-events:all;}
.popup-wrap{position:relative;}
.card-popup{width:min(390px,88vw);background:var(--cream);border-radius:24px;overflow:hidden;box-shadow:0 40px 100px rgba(0,0,0,0.6);transform:scale(0.4) translateY(80px);opacity:0;transition:transform 0.7s cubic-bezier(.34,1.56,.64,1) 0.1s,opacity 0.5s 0.1s;max-height:92vh;overflow-y:auto;}
.popup-overlay.show .card-popup{transform:scale(1) translateY(0);opacity:1;}
.card-cover{background:linear-gradient(160deg,#3d1f45,#5c2d5e 40%,#e8647a);padding:40px 28px 34px;text-align:center;position:relative;overflow:hidden;}
.card-cover::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 30% 20%,rgba(255,255,255,0.08) 0%,transparent 60%);}
.card-cover-emoji{font-size:54px;display:block;margin-bottom:12px;animation:bounceIn 0.8s ease 0.5s both;}
.card-cover-title{font-family:'Playfair Display',serif;font-style:italic;font-size:12px;color:var(--blush);letter-spacing:4px;text-transform:uppercase;margin-bottom:6px;}
.card-cover-name{font-family:'Playfair Display',serif;font-size:36px;font-weight:700;color:#fff;margin-bottom:8px;}
.card-cover-date{font-size:11px;color:rgba(255,255,255,0.5);letter-spacing:3px;}
.card-body{padding:28px 26px;}
.card-section{margin-bottom:20px;}
.card-section-label{font-size:10px;letter-spacing:3px;text-transform:uppercase;color:var(--rose);font-weight:600;margin-bottom:6px;}
.card-section-text{font-size:14px;line-height:1.85;color:#4a3040;font-weight:300;}
.wishes-box{background:linear-gradient(135deg,#fce8ed,#f8e8f8);border-radius:14px;padding:16px 20px;border-left:3px solid var(--rose);margin-bottom:20px;}
.wishes-box p{font-size:13.5px;line-height:1.9;color:#5a3050;font-weight:300;}
.wish-item::before{content:'‚ú¶ ';color:var(--gold);font-size:11px;}
.card-footer{background:linear-gradient(90deg,#3d1f45,#e8647a,#c9a96e,#e8647a,#3d1f45);background-size:200%;animation:shimmer 4s linear infinite;padding:13px;text-align:center;font-size:12px;color:rgba(255,255,255,0.9);letter-spacing:2px;font-family:'Playfair Display',serif;font-style:italic;}
@keyframes shimmer{0%{background-position:0%;}100%{background-position:200%;}}
.close-btn{position:absolute;top:-14px;right:-14px;width:36px;height:36px;border-radius:50%;background:var(--rose);border:none;color:white;font-size:16px;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,0.3);display:flex;align-items:center;justify-content:center;z-index:10;}
.confetti-piece{position:fixed;width:9px;height:9px;top:-10px;pointer-events:none;z-index:600;border-radius:2px;animation:confettiFall linear forwards;}
@keyframes confettiFall{0%{transform:translateY(0) rotate(0deg);opacity:1;}100%{transform:translateY(105vh) rotate(720deg);opacity:0;}}
.spark{position:fixed;pointer-events:none;z-index:400;animation:sparkFloat 0.9s ease-out forwards;font-size:14px;}
@keyframes sparkFloat{0%{transform:translateY(0) scale(1);opacity:1;}100%{transform:translateY(-60px) scale(0);opacity:0;}}
::-webkit-scrollbar{width:4px;}::-webkit-scrollbar-track{background:transparent;}::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.1);border-radius:2px;}
.gift-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.85);backdrop-filter:blur(12px);z-index:700;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity 0.5s;}
.gift-overlay.show{opacity:1;pointer-events:all;}
.gift-box-wrap{text-align:center;}
.gift-title{font-family:'Playfair Display',serif;font-style:italic;font-size:22px;color:var(--blush);margin-bottom:24px;}
.gift-box{width:140px;height:120px;margin:0 auto 24px;position:relative;cursor:pointer;transition:transform 0.2s;}
.gift-box:hover{transform:scale(1.05);}
.gift-body{position:absolute;bottom:0;left:0;right:0;height:80px;background:linear-gradient(135deg,#e8647a,#c94560);border-radius:6px;box-shadow:0 8px 30px rgba(232,100,122,0.5);}
.gift-lid{position:absolute;top:26px;left:-6px;right:-6px;height:32px;background:linear-gradient(135deg,#c94560,#e8647a);border-radius:6px;transition:transform 0.8s cubic-bezier(.34,1.8,.64,1);}
.gift-lid.open{transform:translateY(-60px) rotate(-12deg);}
.gift-ribbon-v{position:absolute;left:50%;transform:translateX(-50%);bottom:0;width:18px;height:80px;background:linear-gradient(to bottom,#ffe082,#c9a96e);border-radius:2px;z-index:1;}
.gift-ribbon-h{position:absolute;top:26px;left:-6px;right:-6px;height:32px;background:transparent;z-index:2;display:flex;align-items:center;justify-content:center;}
.gift-ribbon-h::after{content:'';width:100%;height:18px;background:linear-gradient(to right,#ffe082,#c9a96e,#ffe082);border-radius:2px;}
.gift-bow{position:absolute;top:8px;left:50%;transform:translateX(-50%);z-index:3;font-size:36px;}
.gift-open-text{font-size:14px;color:rgba(255,255,255,0.5);letter-spacing:1px;animation:pulse 2s ease-in-out infinite;}
.gift-result{display:none;text-align:center;}
.gift-result.show{display:block;}
.gift-result-emoji{font-size:64px;display:block;margin-bottom:12px;animation:bounceIn 0.8s ease both;}
.gift-result-text{font-family:'Playfair Display',serif;font-style:italic;font-size:20px;color:#fff;margin-bottom:16px;line-height:1.5;}
.gift-result-btn{padding:12px 32px;background:linear-gradient(135deg,var(--rose),#c94560);color:white;border:none;border-radius:12px;font-family:'Sarabun',sans-serif;font-size:14px;font-weight:600;cursor:pointer;}
</style>
</head>
<body>
<div class="stars" id="stars"></div>

<!-- PAGE 1 -->
<div class="page active" id="page1">
  <div class="welcome-box" id="welcome-box">
    <span class="welcome-emoji">üå∏</span>
    <div class="welcome-title">Happy Birthday</div>
    <div class="welcome-sub">‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà<br>‡∏Å‡∏£‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î (‡∏û.‡∏®.) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å ‚ú®</div>
    <div class="gold-div"><span>‚ô°</span></div>
    <div class="date-label">‡∏ß‡∏±‡∏ô / ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô / ‡∏õ‡∏µ‡∏û.‡∏®.</div>
    <div class="date-inputs">
      <input type="number" id="inp-day" placeholder="‡∏ß‡∏ß">
      <span class="date-sep">/</span>
      <input type="number" id="inp-month" placeholder="‡∏î‡∏î">
      <span class="date-sep">/</span>
      <input type="number" id="inp-year" placeholder="‡∏õ‡∏õ‡∏õ‡∏õ">
    </div>
    <button class="btn-enter" onclick="checkDate()">‡∏ï‡∏Å‡∏•‡∏á</button>
    <div class="error-msg" id="error-msg">‚ùå ‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞</div>
  </div>
</div>

<!-- PAGE 2 - CAKE -->
<div class="page" id="page2">
  <div class="cake-page">
    <div class="cake-title">‡πÄ‡∏õ‡πà‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î üéÇ</div>
    <div class="cake-sub">‡πÄ‡∏õ‡πà‡∏≤‡πÅ‡∏Ñ‡πà 2 ‡∏ó‡∏µ‡∏Å‡πá‡∏î‡∏±‡∏ö‡∏´‡∏°‡∏î‡πÄ‡∏•‡∏¢! üå¨Ô∏è</div><br><br>
    <div class="mic-area">
      <div class="mic-label" id="mic-label"></div>
      <div class="vol-bar-wrap" id="vol-bar-wrap" style="display:none;"><div class="vol-bar-fill" id="vol-fill"></div></div>
    </div>
    <div class="cake-wrapper" id="cake-wrapper">
      <svg id="cake-svg" viewBox="0 0 580 300" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="gBotS" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#f9b8d4"/><stop offset="100%" stop-color="#b84878"/></linearGradient>
          <linearGradient id="gBotT" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#fce4f0"/><stop offset="100%" stop-color="#e888b8"/></linearGradient>
          <linearGradient id="gMidS" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#ffd4ea"/><stop offset="100%" stop-color="#e05878"/></linearGradient>
          <linearGradient id="gMidT" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#ffe8f5"/><stop offset="100%" stop-color="#f4a0cc"/></linearGradient>
          <linearGradient id="gTopS" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#fff0e4"/><stop offset="100%" stop-color="#cca060"/></linearGradient>
          <linearGradient id="gTopT" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#fff8ee"/><stop offset="100%" stop-color="#e0c080"/></linearGradient>
          <linearGradient id="gPlate" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" stop-color="#f8eecc"/><stop offset="100%" stop-color="#c8a040"/></linearGradient>
          <filter id="fs"><feDropShadow dx="0" dy="5" stdDeviation="7" flood-color="rgba(0,0,0,0.3)"/></filter>
        </defs>
        <ellipse cx="290" cy="293" rx="200" ry="10" fill="rgba(0,0,0,0.25)"/>
        <ellipse cx="290" cy="282" rx="200" ry="17" fill="url(#gPlate)"/>
        <ellipse cx="290" cy="274" rx="200" ry="14" fill="#f5e6b8"/>
        <ellipse cx="290" cy="272" rx="193" ry="11" fill="none" stroke="rgba(255,255,255,0.5)" stroke-width="2"/>
        <path d="M68 198 L68 264 Q68 274 90 278 L490 278 Q512 274 512 264 L512 198 Z" fill="url(#gBotS)" filter="url(#fs)"/>
        <path d="M80 204 Q92 216 106 204 Q120 216 136 204 Q152 216 168 204 Q184 216 200 204 Q216 216 232 204 Q248 216 264 204 Q280 216 296 204 Q312 216 328 204 Q344 216 360 204 Q376 216 392 204 Q408 216 423 204 Q437 216 452 204 Q464 216 500 204" fill="none" stroke="rgba(255,255,255,0.6)" stroke-width="5.5" stroke-linecap="round"/>
        <line x1="68" y1="233" x2="512" y2="233" stroke="rgba(255,255,255,0.13)" stroke-width="2"/>
        <circle cx="138" cy="233" r="8" fill="#c9a96e"/><circle cx="138" cy="233" r="4" fill="#fff8e1"/>
        <circle cx="213" cy="233" r="8" fill="#c9a96e"/><circle cx="213" cy="233" r="4" fill="#fff8e1"/>
        <circle cx="290" cy="233" r="8" fill="#c9a96e"/><circle cx="290" cy="233" r="4" fill="#fff8e1"/>
        <circle cx="367" cy="233" r="8" fill="#c9a96e"/><circle cx="367" cy="233" r="4" fill="#fff8e1"/>
        <circle cx="442" cy="233" r="8" fill="#c9a96e"/><circle cx="442" cy="233" r="4" fill="#fff8e1"/>
        <ellipse cx="290" cy="198" rx="222" ry="20" fill="url(#gBotT)"/>
        <ellipse cx="290" cy="195" rx="218" ry="16" fill="none" stroke="rgba(255,255,255,0.6)" stroke-width="2.5"/>
        <path d="M122 130 L122 190 Q122 198 144 202 L436 202 Q458 198 458 190 L458 130 Z" fill="url(#gMidS)" filter="url(#fs)"/>
        <path d="M134 137 Q147 149 162 137 Q178 149 195 137 Q212 149 230 137 Q247 149 265 137 Q283 149 301 137 Q319 149 336 137 Q352 149 368 137 Q384 149 400 137 Q415 149 430 137 Q444 149 446 137" fill="none" stroke="rgba(255,255,255,0.65)" stroke-width="5" stroke-linecap="round"/>
        <ellipse cx="290" cy="130" rx="168" ry="17" fill="url(#gMidT)"/>
        <ellipse cx="290" cy="127" rx="163" ry="13" fill="none" stroke="rgba(255,255,255,0.65)" stroke-width="2"/>
        <path d="M178 70 L178 122 Q178 130 196 134 L384 134 Q402 130 402 122 L402 70 Z" fill="url(#gTopS)" filter="url(#fs)"/>
        <path d="M190 77 Q202 88 216 77 Q230 88 246 77 Q262 88 278 77 Q294 88 310 77 Q326 88 342 77 Q356 88 370 77 Q382 88 390 77" fill="none" stroke="rgba(255,255,255,0.7)" stroke-width="4.5" stroke-linecap="round"/>
        <ellipse cx="290" cy="70" rx="112" ry="14" fill="url(#gTopT)"/>
        <ellipse cx="290" cy="68" rx="108" ry="11" fill="none" stroke="rgba(255,255,255,0.75)" stroke-width="2"/>
        <circle cx="290" cy="58" r="10" fill="#ffe082"/>
        <circle cx="290" cy="58" r="5.5" fill="#fff8e1"/>
        <text x="276" y="63" font-size="12" fill="#c9a96e">‚úø</text>
      </svg>
      <div class="candles-container" id="candles-container"></div>
    </div>
    <div class="progress-bar-wrap"><div class="progress-bar-fill" id="progress-fill"></div></div>
    <div class="cake-hint" id="cake-hint">üå¨Ô∏è ‡πÄ‡∏õ‡πà‡∏≤‡πÅ‡∏Ñ‡πà 2 ‡∏ó‡∏µ‡∏Å‡πá‡∏î‡∏±‡∏ö‡∏´‡∏°‡∏î‡πÄ‡∏•‡∏¢!</div>
  </div>
</div>

<!-- PAGE 3 -->
<div class="page" id="page3">
  <div class="photo-wall">
    <div class="photo-wall-title">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ üì∏</div>
    <div class="photo-wall-sub">‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô</div>
    <div class="polaroid-grid" id="polaroid-grid"></div>
    <button class="photo-wall-btn" onclick="goPage(4)">‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‚Üí</button>
  </div>
</div>

<!-- PAGE 4 -->
<div class="page" id="page4">
  <div class="timeline-wrap">
    <div class="tl-header">
      <div class="tl-title">‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ üí´</div>
      <div class="tl-sub">‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
    </div>
    <div class="tl-line" id="tl-line"></div>
    <button class="tl-next-btn" onclick="goPage(5)">‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‚Üí</button>
  </div>
</div>

<!-- PAGE 5 -->
<div class="page" id="page5">
  <div class="env-page">
    <div class="env-label">
      <div class="env-title">‡∏°‡∏µ‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏∏‡∏ì üíå</div>
      <div class="env-hint">‡∏Å‡∏î‡∏ó‡∏µ‡πà‡∏ã‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡πà‡∏≤‡∏ô</div>
    </div>
    <div class="envelope-scene">
      <div class="envelope-wrap" onclick="openEnvelope()">
        <div class="env-body"></div>
        <div class="env-left-fold"></div>
        <div class="env-right-fold"></div>
        <div class="env-flap" id="env-flap"></div>
        <div class="env-seal" id="env-seal">üíå</div>
      </div>
    </div>
  </div>
</div>

<!-- LETTER OVERLAY -->
<div class="letter-overlay" id="letter-overlay">
  <div class="letter-paper">
    <button class="letter-close" onclick="closeLetter()">‚úï</button>
    <div class="letter-content">
      <div class="letter-date">18 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569</div>
      <div class="letter-dear">‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å,</div>
      <div class="letter-body">
        ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠ ‡πÅ‡∏ï‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ñ‡πâ‡∏≤ ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏ò‡∏≠‡∏Å‡πá‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ó‡∏±‡πâ‡∏á‡∏ô‡∏±‡πâ‡∏ô
        <br><br>
        ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏ó‡∏≥‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡πÑ‡∏ß‡πâ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡πÄ‡∏ï‡πà‡∏ï‡πâ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏ó‡∏≥‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        <br><br>
        ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏ò‡∏≠‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡πÑ‡∏ß‡πâ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏¢‡∏¥‡πâ‡∏°‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡πÄ‡∏ò‡∏≠‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏Å ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏™‡∏°‡∏≠ ‚ô°
        <br><br>
        Happy Birthday My Love üå∏
      </div>
    </div>
  </div>
</div>

<!-- PAGE 6 -->
<div class="page" id="page6">
  <div class="jar-scene">
    <div class="jar-title">‡∏ù‡∏≤‡∏Å‡∏ö‡∏≠‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏£‡∏±‡∏Å üíå</div>
    <div class="jar-sub">‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏£‡∏±‡∏Å<br>‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏π‡πâ‡πÄ‡∏•‡∏¢ üíï</div>
    <div class="jar-visual">
      <div class="jar-lid"></div>
      <div class="jar-neck"></div>
      <div class="jar-body">
        <div class="jar-shine"></div>
        <div class="jar-wishes-inside" id="jar-inside"></div>
      </div>
    </div>
    <div class="jar-input-area">
      <textarea class="wish-input" id="wish-input" rows="2" placeholder="‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏≤‡∏£‡∏ñ‡∏ô‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠... ‚ú®" maxlength="80"></textarea>
      <button class="wish-submit-btn" onclick="addWish()">‡πÉ‡∏™‡πà‡πÉ‡∏ô‡πÇ‡∏´‡∏• üåü</button>
      <div class="jar-wishes-list" id="jar-list"></div>
    </div>
    <button class="jar-skip-btn" onclick="goPage(7)">‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‚Üí</button>
  </div>
</div>

<!-- PAGE 7 -->
<div class="page" id="page7">
  <div class="countdown-scene">
    <div class="cd-title">‡πÄ‡∏ò‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡πâ‡∏≤‡∏£‡∏±‡∏Å‡πÅ‡∏•‡πâ‡∏ß... ‚è≥</div>
    <div class="cd-grid">
      <div class="cd-box"><div class="cd-num" id="cd-days">000</div><div class="cd-unit">‡∏ß‡∏±‡∏ô</div></div>
      <div class="cd-box"><div class="cd-num" id="cd-hours">00</div><div class="cd-unit">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</div></div>
      <div class="cd-box"><div class="cd-num" id="cd-mins">00</div><div class="cd-unit">‡∏ô‡∏≤‡∏ó‡∏µ</div></div>
      <div class="cd-box"><div class="cd-num" id="cd-secs">00</div><div class="cd-unit">‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</div></div>
    </div>
    <div class="cd-msg">" ‡∏ó‡∏∏‡∏Å‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏ö ‡∏Ñ‡∏∑‡∏≠‡∏ó‡∏∏‡∏Å‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å "<br>‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡∏à‡∏∞‡∏£‡∏±‡∏Å‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏≠‡∏µ‡∏Å‡∏ô‡∏≤‡∏ô‡∏°‡∏≤‡∏Å ‚ô°</div>
    <button class="cd-final-btn" onclick="goPage(8)">‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‚Üí</button>
  </div>
</div>

<!-- PAGE 8 -->
<div class="page" id="page8">
  <div class="song-scene">
    <div class="song-disc" id="song-disc"><div class="disc-center">üéµ</div></div>
    <div class="song-title-el">‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ üé∂</div>
    <div class="song-artist">Lingrom ‚Ä¢ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ò‡∏≠‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</div>
    <div class="song-controls">
      <button class="play-btn" id="play-btn" onclick="togglePlay()">‚ñ∂</button>
    </div>
    <div class="song-progress" onclick="seekSong(event)"><div class="song-prog-fill" id="song-prog"></div></div>
    <div class="song-time"><span id="s-cur">0:00</span><span id="s-dur">0:00</span></div>
    <div id="yt-player" style="position:absolute;opacity:0;pointer-events:none;width:1px;height:1px;"></div>
    <div class="lyrics-box">
      <div class="lyric-line active" id="lyric-0">‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô ‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏ò‡∏≠ ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ üå∏</div>
      <div class="lyric-line" id="lyric-1">‡∏à‡∏∞‡∏Ñ‡∏≠‡∏¢ ‡∏°‡∏µ‡∏Ñ‡∏≥‡πÑ‡∏õ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÑ‡∏õ üíï</div>
      <div class="lyric-line" id="lyric-2">‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡πà‡∏á‡πÉ‡∏´‡∏ç‡πà ‡∏Ñ‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ üåô</div>
      <div class="lyric-line" id="lyric-3">‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏µ‡πâ ‡∏â‡∏±‡∏ô‡∏Å‡πá‡∏î‡∏µ‡πÉ‡∏à ‚ú®</div>
    </div>
    <button class="song-next-btn" onclick="showFinalCard()">‡∏î‡∏π‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î üå∏</button>
  </div>
</div>

<!-- GIFT OVERLAY -->
<div class="gift-overlay" id="gift-overlay">
  <div class="gift-box-wrap">
    <div id="gift-pre">
      <div class="gift-title">üéÅ ‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏£‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà!</div>
      <div class="gift-box" onclick="openGift()">
        <div class="gift-body"></div>
        <div class="gift-ribbon-v"></div>
        <div class="gift-ribbon-h"></div>
        <div class="gift-lid" id="gift-lid"></div>
        <div class="gift-bow">üéÄ</div>
      </div>
      <div class="gift-open-text">‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î! ‚ú®</div>
    </div>
    <div class="gift-result" id="gift-result">
      <span class="gift-result-emoji">üåπ</span>
      <div class="gift-result-text">‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡πâ‡∏≤‡∏°‡∏µ‡πÉ‡∏´‡πâ<br>‡∏Ñ‡∏∑‡∏≠‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏î‡∏ß‡∏á‡∏ô‡∏µ‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏•‡∏¢ ‚ô°</div>
      <button class="gift-result-btn" onclick="showFinalCard()">‡∏î‡∏π‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î üå∏</button>
    </div>
  </div>
</div>

<!-- FINAL CARD -->
<div class="popup-overlay" id="popup-overlay">
  <div class="popup-wrap">
    <button class="close-btn" onclick="closePopup()">‚úï</button>
    <div class="card-popup">
      <div class="card-cover">
        <span class="card-cover-emoji">üå∏</span>
        <div class="card-cover-title">Happy Birthday</div>
        <div class="card-cover-name">My Love</div>
        <div class="card-cover-date">18 ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569</div>
      </div>
      <div class="card-body">
        <div class="card-section">
          <div class="card-section-label">‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</div>
          <div class="card-section-text">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ß‡∏±‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÉ‡∏ô‡∏õ‡∏µ<br>‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏ò‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡∏°‡∏≤‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏•‡∏Å‡∏ô‡∏µ‡πâ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡∏Ç‡∏∂‡πâ‡∏ô üå∑</div>
        </div>
        <div class="card-section">
          <div class="card-section-label">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤</div>
          <div class="card-section-text">‡∏ó‡∏∏‡∏Å‡πÇ‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞ ‡∏¢‡∏¥‡πâ‡∏° ‡∏£‡πâ‡∏≠‡∏á‡πÑ‡∏´‡πâ ‡∏•‡πâ‡∏ß‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡πÉ‡∏à‡πÄ‡∏™‡∏°‡∏≠ ‚ô°</div>
        </div>
        <div class="wishes-box">
          <div class="card-section-label" style="margin-bottom:10px;">‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡∏à‡∏≤‡∏Å‡πÉ‡∏à</div>
          <p class="wish-item">‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ô‡∏∞‡∏Ñ‡∏ô‡πÄ‡∏Å‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤ ‡∏Ñ‡∏£‡∏ö 24 ‡∏õ‡∏µ‡πÅ‡∏•‡πâ‡∏ß</p>
          <p class="wish-item">‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠‡πÄ‡∏•‡∏¢‡∏ô‡∏∞</p>
          <p class="wish-item">‡∏°‡∏µ‡πÅ‡∏ï‡πà‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏° ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞ ‡πÅ‡∏•‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡πÑ‡∏ß‡πâ</p>
          <p class="wish-item">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ô‡∏∞</p>
          <p class="wish-item">‡∏≠‡∏≤‡∏¢‡∏∏ 24 ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡πá‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏î‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°</p>
          <p class="wish-item">‡∏£‡∏±‡∏Å‡πÄ‡∏ò‡∏≠‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å‡πÄ‡∏•‡∏¢‡∏ô‡∏∞</p>
        </div>
      </div>
      <div class="card-footer">" ‡∏£‡∏±‡∏Å‡πÄ‡∏ò‡∏≠‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î "</div>
    </div>
  </div>
</div>

<script>
/* STARS */
const starsEl=document.getElementById('stars');
for(let i=0;i<90;i++){
  const s=document.createElement('div');s.className='star';
  const sz=Math.random()*2.5+0.5;
  s.style.cssText=`width:${sz}px;height:${sz}px;left:${Math.random()*100}%;top:${Math.random()*100}%;--dur:${Math.random()*3+2}s;--delay:${Math.random()*5}s`;
  starsEl.appendChild(s);
}

/* PAGE NAV */
function goPage(n){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById('page'+n).classList.add('active');
  if(n===4)buildTimeline();
  if(n===7)startCountdown();
  if(n===8)startSong();
}

/* PAGE 1 */
const CORRECT={day:18,month:2,year:2545};
function checkDate(){
  const d=parseInt(document.getElementById('inp-day').value);
  const m=parseInt(document.getElementById('inp-month').value);
  const y=parseInt(document.getElementById('inp-year').value);
  const err=document.getElementById('error-msg');
  const box=document.getElementById('welcome-box');
  if(d===CORRECT.day&&m===CORRECT.month&&y===CORRECT.year){
    err.classList.remove('show');
    box.style.transform='scale(1.05)';box.style.boxShadow='0 0 80px rgba(201,169,110,0.7)';
    launchConfetti(40);
    setTimeout(()=>{box.style.opacity='0';box.style.transform='scale(0.85)';},400);
    setTimeout(()=>{goPage(2);buildCake();},1000);
  } else {
    err.classList.add('show');box.classList.remove('shake');void box.offsetWidth;box.classList.add('shake');
    setTimeout(()=>box.classList.remove('shake'),500);
  }
}
['inp-day','inp-month','inp-year'].forEach(id=>{
  document.getElementById(id).addEventListener('keydown',e=>{if(e.key==='Enter')checkDate();});
});

/* PAGE 2: CAKE */
const CSTYLES=[
  {body:'linear-gradient(180deg,#ff9ad5,#e8507a)',base:'linear-gradient(180deg,#c03060,#902050)',drip:'#ffb8e0',h:54},
  {body:'linear-gradient(180deg,#ffe066,#ff9a00)',base:'linear-gradient(180deg,#cc7800,#994400)',drip:'#ffe599',h:48},
  {body:'linear-gradient(180deg,#c9b4fb,#7c4dff)',base:'linear-gradient(180deg,#5535cc,#3010aa)',drip:'#d1c4e9',h:58},
  {body:'linear-gradient(180deg,#80deea,#0097a7)',base:'linear-gradient(180deg,#007788,#005566)',drip:'#b2ebf2',h:46},
  {body:'linear-gradient(180deg,#a5d6a7,#388e3c)',base:'linear-gradient(180deg,#2a6e2e,#1a4e1e)',drip:'#c8e6c9',h:52},
];
const CANDLE_X_FRAC=[202/580,242/580,290/580,338/580,378/580];
const TOP_TIER_Y_FRAC=62/300;
let candleLit=[true,true,true,true,true],builtCake=false;

// ===== ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏±‡∏ö‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πà‡∏≤ =====
// ‡∏ó‡∏µ‡πÅ‡∏£‡∏Å: ‡∏î‡∏±‡∏ö 2 ‡πÄ‡∏•‡πà‡∏°, ‡∏ó‡∏µ‡∏™‡∏≠‡∏á: ‡∏î‡∏±‡∏ö 3 ‡πÄ‡∏•‡πà‡∏° (‡∏î‡∏±‡∏ö‡∏´‡∏°‡∏î)
let blowCount=0;
const BLOW_PLAN=[2,3];

function buildCake(){
  if(builtCake)return;builtCake=true;
  renderCandles();startMic();
}
function renderCandles(){
  const cont=document.getElementById('candles-container');
  cont.innerHTML='';
  const svgEl=document.getElementById('cake-svg');
  const r=svgEl.getBoundingClientRect();
  const sw=r.width,sh=r.height;
  CSTYLES.forEach((cs,i)=>{
    const xPx=CANDLE_X_FRAC[i]*sw;
    const yTopPx=TOP_TIER_Y_FRAC*sh;
    const totalH=cs.h+34+7+7+7;
    const topY=yTopPx-totalH+7;
    const wrap=document.createElement('div');
    wrap.className='candle-wrap';wrap.id='cw-'+i;
    wrap.style.left=xPx+'px';wrap.style.top=topY+'px';
    const lit=candleLit[i];
    wrap.innerHTML=`
      <div class="c-flame-area${lit?'':' out'}" id="cf-${i}">
        <div class="c-glow"></div>
        <div class="c-flame-outer"></div>
        <div class="c-flame-inner"></div>
      </div>
      <div class="c-wick-tip" style="${lit?'background:#ff6600;box-shadow:0 0 4px #ff9900':''}"></div>
      <div class="c-wick"></div>
      <div class="c-body${lit?' drip-active':''}" style="height:${cs.h}px;background:${cs.body};">
        <div class="c-body-shine"></div>
        <div class="c-drip" style="background:${cs.drip};height:${lit?'14px':'0'};"></div>
      </div>
      <div class="c-base" style="background:${cs.base};"></div>
      <div class="c-smoke-emoji" id="cs-${i}">üí®</div>`;
    cont.appendChild(wrap);
  });
  updateProgress();
}

// ‡∏î‡∏±‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô count ‡πÄ‡∏•‡πà‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô (‡πÄ‡∏•‡πà‡∏°‡∏™‡∏∏‡πà‡∏°)
function extinguishBatch(count){
  const alive=candleLit.map((v,i)=>v?i:-1).filter(i=>i>=0);
  if(!alive.length)return;
  // ‡∏™‡∏∏‡πà‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å count ‡πÄ‡∏•‡πà‡∏°‡πÅ‡∏£‡∏Å
  const pick=[...alive].sort(()=>Math.random()-0.5).slice(0,count);
  pick.forEach((idx,k)=>{
    setTimeout(()=>{
      candleLit[idx]=false;
      const fa=document.getElementById('cf-'+idx);
      if(fa){fa.classList.add('out');const g=fa.querySelector('.c-glow');if(g)g.style.display='none';}
      const sm=document.getElementById('cs-'+idx);
      if(sm){sm.classList.add('puffing');setTimeout(()=>sm.classList.remove('puffing'),1200);}
      sparkAt(idx);
      updateProgress();
      // ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏°‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÉ‡∏ô‡∏ä‡∏∏‡∏î‡∏ô‡∏µ‡πâ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏î‡∏±‡∏ö‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
      if(k===pick.length-1 && candleLit.filter(v=>v).length===0){
        document.getElementById('cake-hint').textContent='üéâ ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô‡∏î‡∏±‡∏ö‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß! ‡πÑ‡∏õ‡∏ï‡πà‡∏≠...';
        document.getElementById('cake-hint').style.color='var(--gold)';
        document.getElementById('cake-hint').style.animation='none';
        stopMic();launchConfetti(70);
        setTimeout(()=>goPage(3),1500);
      }
    },k*180);
  });
}

function updateProgress(){
  const out=candleLit.filter(v=>!v).length;
  document.getElementById('progress-fill').style.width=((CSTYLES.length-out)/CSTYLES.length*100)+'%';
}
function sparkAt(idx){
  const el=document.getElementById('cw-'+idx);if(!el)return;
  const rect=el.getBoundingClientRect();
  ['üí®','üå¨Ô∏è','‚ú®','‚ù§Ô∏è'].forEach((em,k)=>{
    setTimeout(()=>{
      const sp=document.createElement('div');sp.className='spark';sp.textContent=em;
      sp.style.left=(rect.left+rect.width/2+(Math.random()-0.5)*44)+'px';
      sp.style.top=rect.top+'px';
      document.body.appendChild(sp);setTimeout(()=>sp.remove(),950);
    },k*75);
  });
}

let audioCtx=null,analyser=null,micStream=null,rafId=null,isListening=false;
let blowCooldown=false,volBuf=[],BUF=6,THRESH=0.05;

async function startMic(){
  try{
    const stream=await navigator.mediaDevices.getUserMedia({audio:true,video:false});
    micStream=stream;
    audioCtx=new(window.AudioContext||window.webkitAudioContext)();
    analyser=audioCtx.createAnalyser();analyser.fftSize=512;
    audioCtx.createMediaStreamSource(stream).connect(analyser);
    isListening=true;detect();
  }catch(e){
    document.getElementById('mic-label').textContent='‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏°‡∏Ñ‡πå‡πÑ‡∏î‡πâ';
    console.warn('mic unavailable');
  }
}
function stopMic(){
  isListening=false;if(rafId){cancelAnimationFrame(rafId);rafId=null;}
  micStream&&micStream.getTracks().forEach(t=>t.stop());
  audioCtx&&audioCtx.close();audioCtx=micStream=analyser=null;
}
function detect(){
  if(!isListening||!analyser)return;
  const buf=new Uint8Array(analyser.frequencyBinCount);
  analyser.getByteTimeDomainData(buf);
  let s=0;for(let i=0;i<buf.length;i++){const v=(buf[i]/128)-1;s+=v*v;}
  const rms=Math.sqrt(s/buf.length);
  document.getElementById('vol-fill').style.width=Math.min(rms*5*100,100)+'%';
  volBuf.push(rms);if(volBuf.length>BUF)volBuf.shift();
  const avg=volBuf.reduce((a,b)=>a+b,0)/volBuf.length;

  if(avg>THRESH&&!blowCooldown){
    blowCooldown=true;
    if(blowCount<BLOW_PLAN.length && candleLit.filter(v=>v).length>0){
      extinguishBatch(BLOW_PLAN[blowCount]);
      blowCount++;
    }
    // cooldown ‡∏ô‡∏≤‡∏ô‡∏û‡∏≠‡πÉ‡∏´‡πâ animation ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏ó‡∏µ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
    setTimeout(()=>{blowCooldown=false;},1500);
  }
  rafId=requestAnimationFrame(detect);
}

/* PAGE 3: PHOTO WALL */
const PHOTOS=[
  {img:'https://img2.pic.in.th/S__21872647_0.jpg',c1:'#f9c4cf',c2:'#e8647a',cap:'‡πÑ‡∏õ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô',rot:'-3deg',del:'0.1s'},
  {img:'https://img5.pic.in.th/file/secure-sv1/S__21872648_0.jpg',c1:'#ffe082',c2:'#ff9800',cap:'‡πÑ‡∏õ‡∏î‡∏π‡∏´‡∏ô‡∏±‡∏á',rot:'2deg',del:'0.2s'},
  {img:'https://img2.pic.in.th/S__21872645_0.jpg',c1:'#c9b4fb',c2:'#7c4dff',cap:'‡πÉ‡∏™‡πà‡∏ö‡∏≤‡∏ï‡∏£‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î',rot:'-2deg',del:'0.3s'},
  {img:'https://img5.pic.in.th/file/secure-sv1/S__21872646_0.jpg',c1:'#80cbc4',c2:'#00897b',cap:'üíô',rot:'3deg',del:'0.4s'},
  {img:'https://img2.pic.in.th/S__21872649_0.jpg',c1:'#f4a7b3',c2:'#e8647a',cap:'‡∏ä‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡∏ô‡∏µ‡πâ',rot:'-1deg',del:'0.5s'},
  {img:'https://img2.pic.in.th/S__21872651.jpg',c1:'#b39ddb',c2:'#7c5c8a',cap:'‡∏û‡∏≤‡∏Å‡∏±‡∏ô‡∏ä‡πá‡∏≠‡∏õ',rot:'2.5deg',del:'0.6s'},
];
(function buildPhotoWall(){
  const grid=document.getElementById('polaroid-grid');
  PHOTOS.forEach(p=>{
    const d=document.createElement('div');
    d.className='polaroid';
    d.style.cssText=`--rot:${p.rot};--del:${p.del};--c1:${p.c1};--c2:${p.c2};`;
    d.innerHTML=`<div class="polaroid-img"><img src="${p.img}" style="width:100%;height:100%;object-fit:cover;"></div><div class="polaroid-caption">${p.cap}</div>`;
    grid.appendChild(d);
  });
})();

/* PAGE 4: TIMELINE */
const TIMELINE=[
  {date:'‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å',emoji:'üëÄ',text:'‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô ‡∏ï‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡πÄ‡∏•‡∏¢‡∏ß‡πà‡∏≤‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ',del:'0.2s'},
  {date:'‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î',emoji:'üíï',text:'‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß ‡πÑ‡∏î‡πâ‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô ‡∏ó‡∏≥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡πÄ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà',del:'0.4s'},
  {date:'‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏©',emoji:'üåô',text:'‡πÑ‡∏î‡πâ‡∏ô‡∏≠‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏ó‡∏∏‡∏Å‡πÄ‡∏ä‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏∑‡πà‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏î‡πâ‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô',del:'0.6s'},
  {date:'‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ',emoji:'üå∏',text:'‡∏Ñ‡∏£‡∏ö 24 ‡∏õ‡∏µ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏ò‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô',del:'0.8s'},
];
function buildTimeline(){
  const line=document.getElementById('tl-line');line.innerHTML='';
  TIMELINE.forEach(t=>{
    const item=document.createElement('div');item.className='tl-item';item.style.setProperty('--del',t.del);
    item.innerHTML=`<div class="tl-dot"></div><div class="tl-card"><span class="tl-emoji">${t.emoji}</span><div class="tl-date">${t.date}</div><div class="tl-text">${t.text}</div></div>`;
    line.appendChild(item);
  });
}

/* PAGE 5: ENVELOPE */
let envOpened=false;
function openEnvelope(){
  if(envOpened)return;envOpened=true;
  document.getElementById('env-flap').classList.add('open');
  document.getElementById('env-seal').style.display='none';
  setTimeout(()=>document.getElementById('letter-overlay').classList.add('show'),600);
}
function closeLetter(){
  document.getElementById('letter-overlay').classList.remove('show');
  setTimeout(()=>goPage(6),400);
}

/* PAGE 6: WISH JAR */
const TG_TOKEN='8556802047:AAG8_SrbotZ4ZUa8adIkaOOTz1NQ0szxbmM';
const TG_CHAT='2090064765';
function addWish(){
  const input=document.getElementById('wish-input');
  const text=input.value.trim();if(!text)return;
  input.value='';
  fetch(`https://api.telegram.org/bot${TG_TOKEN}/sendMessage`,{
    method:'POST',headers:{'Content-Type':'application/json'},
    body:JSON.stringify({chat_id:TG_CHAT,text:`üíå ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡∏Ñ‡∏∏‡∏ì:\n\n"${text}"\n\nüéÇ Happy Birthday 18/02/2569`})
  }).catch(()=>{});
  const inside=document.getElementById('jar-inside');
  const note=document.createElement('div');note.className='wish-note';
  note.style.setProperty('--r',(Math.random()*20-10)+'deg');inside.appendChild(note);
  const list=document.getElementById('jar-list');
  const item=document.createElement('div');item.className='jar-wish-item';item.textContent=text;
  list.appendChild(item);list.scrollTop=list.scrollHeight;launchConfetti(8);
}
document.getElementById('wish-input').addEventListener('keydown',e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();addWish();}});

/* PAGE 7: COUNTDOWN */
let cdTimer=null;
const LOVE_START=new Date('2002-02-18T00:00:00');
function startCountdown(){
  if(cdTimer)clearInterval(cdTimer);
  function update(){
    const diff=new Date()-LOVE_START;
    const days=Math.floor(diff/86400000);
    const hours=Math.floor((diff%86400000)/3600000);
    const mins=Math.floor((diff%3600000)/60000);
    const secs=Math.floor((diff%60000)/1000);
    document.getElementById('cd-days').textContent=String(days).padStart(3,'0');
    document.getElementById('cd-hours').textContent=String(hours).padStart(2,'0');
    document.getElementById('cd-mins').textContent=String(mins).padStart(2,'0');
    document.getElementById('cd-secs').textContent=String(secs).padStart(2,'0');
  }
  update();cdTimer=setInterval(update,1000);
}

/* PAGE 8: SONG */
const SONG_START_SEC=61,CLIP_DUR=20;
const LYRICS_DATA=[
  {rel:0,text:'‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô ‡∏Ñ‡∏≥‡∏≠‡∏ß‡∏¢‡∏û‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏ò‡∏≠ ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ üå∏'},
  {rel:5,text:'‡∏à‡∏∞‡∏Ñ‡∏≠‡∏¢ ‡∏°‡∏µ‡∏Ñ‡∏≥‡πÑ‡∏õ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÑ‡∏õ üíï'},
  {rel:10,text:'‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡πà‡∏á‡πÉ‡∏´‡∏ç‡πà ‡∏Ñ‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ üåô'},
  {rel:15,text:'‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏µ‡πâ ‡∏â‡∏±‡∏ô‡∏Å‡πá‡∏î‡∏µ‡πÉ‡∏à ‚ú®'},
];
let ytPlayer=null,ytReady=false,ytPlaying=false,ytProgTimer=null;
function loadYouTubeAPI(){
  if(window.YT&&window.YT.Player){createYTPlayer();return;}
  const tag=document.createElement('script');tag.src='https://www.youtube.com/iframe_api';document.head.appendChild(tag);
}
window.onYouTubeIframeAPIReady=function(){createYTPlayer();};
function createYTPlayer(){
  ytPlayer=new YT.Player('yt-player',{
    height:'1',width:'1',videoId:'AG47IuZNAFs',
    playerVars:{start:SONG_START_SEC,autoplay:0,controls:0,rel:0,fs:0,disablekb:1},
    events:{
      onReady:()=>{ytReady=true;document.getElementById('s-dur').textContent=fmtTime(CLIP_DUR);},
      onStateChange:(e)=>{
        if(e.data===YT.PlayerState.PLAYING){ytPlaying=true;document.getElementById('play-btn').textContent='‚è∏';document.getElementById('song-disc').classList.add('playing');startYTProgress();}
        else if(e.data===YT.PlayerState.PAUSED||e.data===YT.PlayerState.ENDED){ytPlaying=false;document.getElementById('play-btn').textContent='‚ñ∂';document.getElementById('song-disc').classList.remove('playing');stopYTProgress();}
      }
    }
  });
}
function startSong(){loadYouTubeAPI();}
function togglePlay(){if(!ytReady){alert('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏û‡∏•‡∏á ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...');return;}ytPlaying?ytPlayer.pauseVideo():ytPlayer.playVideo();}
function startYTProgress(){
  if(ytProgTimer)clearInterval(ytProgTimer);
  ytProgTimer=setInterval(()=>{
    if(!ytPlayer||!ytReady)return;
    const relSec=ytPlayer.getCurrentTime()-SONG_START_SEC;
    const pct=Math.min(Math.max(relSec/CLIP_DUR*100,0),100);
    document.getElementById('song-prog').style.width=pct+'%';
    document.getElementById('s-cur').textContent=fmtTime(Math.max(relSec,0));
    let li=0;LYRICS_DATA.forEach((l,i)=>{if(relSec>=l.rel)li=i;});
    for(let i=0;i<LYRICS_DATA.length;i++)document.getElementById('lyric-'+i).classList.toggle('active',i===li);
    if(relSec>=CLIP_DUR){ytPlayer.pauseVideo();stopYTProgress();}
  },200);
}
function stopYTProgress(){if(ytProgTimer){clearInterval(ytProgTimer);ytProgTimer=null;}}
function seekSong(e){if(!ytReady)return;const rect=e.currentTarget.getBoundingClientRect();const ratio=Math.max(0,Math.min(1,(e.clientX-rect.left)/rect.width));ytPlayer.seekTo(SONG_START_SEC+ratio*CLIP_DUR,true);}
function fmtTime(s){s=Math.max(0,s);return Math.floor(s/60)+':'+(Math.floor(s%60)).toString().padStart(2,'0');}

/* GIFT & FINAL */
function openGift(){document.getElementById('gift-lid').classList.add('open');launchConfetti(80);setTimeout(()=>{document.getElementById('gift-pre').style.display='none';document.getElementById('gift-result').classList.add('show');},900);}
function showFinalCard(){document.getElementById('gift-overlay').classList.remove('show');document.getElementById('popup-overlay').classList.add('show');launchConfetti(140);}
function closePopup(){document.getElementById('popup-overlay').classList.remove('show');}
document.getElementById('popup-overlay').addEventListener('click',function(e){if(e.target===this)closePopup();});

/* CONFETTI */
function launchConfetti(count){
  const cols=['#e8647a','#c9a96e','#f4a7b3','#7c5c8a','#fff','#ffcc00','#6bbfff','#9fff6b'];
  for(let i=0;i<count;i++){
    setTimeout(()=>{
      const c=document.createElement('div');c.className='confetti-piece';
      c.style.cssText=`left:${Math.random()*100}%;background:${cols[Math.floor(Math.random()*cols.length)]};animation-duration:${Math.random()*2+1.5}s;border-radius:${Math.random()>0.5?'50%':'2px'}`;
      document.body.appendChild(c);setTimeout(()=>c.remove(),4000);
    },i*16);
  }
}
window.addEventListener('resize',()=>{if(builtCake)renderCandles();});
</script>
</body>
</html>
